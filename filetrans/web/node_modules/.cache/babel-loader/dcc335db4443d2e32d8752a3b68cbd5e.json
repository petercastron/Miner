{"remainingRequest":"F:\\viteFiles\\teston\\node_modules\\babel-loader\\lib\\index.js!F:\\viteFiles\\teston\\src\\store\\modules\\permission.js","dependencies":[{"path":"F:\\viteFiles\\teston\\src\\store\\modules\\permission.js","mtime":1655175427446},{"path":"F:\\viteFiles\\teston\\babel.config.js","mtime":1623402045953},{"path":"F:\\viteFiles\\teston\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1617866813583},{"path":"F:\\viteFiles\\teston\\node_modules\\babel-loader\\lib\\index.js","mtime":1668408460122}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgY29uc3RhbnRSb3V0ZXJNYXAgfSBmcm9tICdAL3JvdXRlci9pbmRleCc7CgovL+WIpOaWreaYr+WQpuacieadg+mZkOiuv+mXruivpeiPnOWNlQpmdW5jdGlvbiBoYXNQZXJtaXNzaW9uKG1lbnVzLCByb3V0ZSkgewogIGlmIChyb3V0ZS5uYW1lKSB7CiAgICBsZXQgY3Vyck1lbnUgPSBnZXRNZW51KHJvdXRlLm5hbWUsIG1lbnVzKTsKICAgIGlmIChjdXJyTWVudSAhPSBudWxsKSB7CiAgICAgIC8v6K6+572u6I+c5Y2V55qE5qCH6aKY44CB5Zu+5qCH5ZKM5Y+v6KeB5oCnCiAgICAgIGlmIChjdXJyTWVudS50aXRsZSAhPSBudWxsICYmIGN1cnJNZW51LnRpdGxlICE9PSAnJykgewogICAgICAgIHJvdXRlLm1ldGEudGl0bGUgPSBjdXJyTWVudS50aXRsZTsKICAgICAgfQogICAgICBpZiAoY3Vyck1lbnUuaWNvbiAhPSBudWxsICYmIGN1cnJNZW51LnRpdGxlICE9PSAnJykgewogICAgICAgIHJvdXRlLm1ldGEuaWNvbiA9IGN1cnJNZW51Lmljb247CiAgICAgIH0KICAgICAgaWYgKGN1cnJNZW51LmhpZGRlbiAhPSBudWxsKSB7CiAgICAgICAgcm91dGUuaGlkZGVuID0gY3Vyck1lbnUuaGlkZGVuICE9PSAwOwogICAgICB9CiAgICAgIGlmIChjdXJyTWVudS5zb3J0ICE9IG51bGwgJiYgY3Vyck1lbnUuc29ydCAhPT0gJycpIHsKICAgICAgICByb3V0ZS5zb3J0ID0gY3Vyck1lbnUuc29ydDsKICAgICAgfQogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0gZWxzZSB7CiAgICAgIHJvdXRlLnNvcnQgPSAwOwogICAgICBpZiAocm91dGUuaGlkZGVuICE9PSB1bmRlZmluZWQgJiYgcm91dGUuaGlkZGVuID09PSB0cnVlKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9CiAgfSBlbHNlIHsKICAgIHJldHVybiB0cnVlOwogIH0KfQoKLy/moLnmja7ot6/nlLHlkI3np7Dojrflj5boj5zljZUKZnVuY3Rpb24gZ2V0TWVudShuYW1lLCBtZW51cykgewogIGZvciAobGV0IGkgPSAwOyBpIDwgbWVudXMubGVuZ3RoOyBpKyspIHsKICAgIGxldCBtZW51ID0gbWVudXNbaV07CiAgICBpZiAobmFtZSA9PT0gbWVudS5uYW1lKSB7CiAgICAgIHJldHVybiBtZW51OwogICAgfQogIH0KICByZXR1cm4gbnVsbDsKfQoKLy/lr7noj5zljZXov5vooYzmjpLluo8KZnVuY3Rpb24gc29ydFJvdXRlcnMoYWNjZXNzZWRSb3V0ZXJzKSB7CiAgZm9yIChsZXQgaSA9IDA7IGkgPCBhY2Nlc3NlZFJvdXRlcnMubGVuZ3RoOyBpKyspIHsKICAgIGxldCByb3V0ZXIgPSBhY2Nlc3NlZFJvdXRlcnNbaV07CiAgICBpZiAocm91dGVyLmNoaWxkcmVuICYmIHJvdXRlci5jaGlsZHJlbi5sZW5ndGggPiAwKSB7CiAgICAgIHJvdXRlci5jaGlsZHJlbi5zb3J0KGNvbXBhcmUoInNvcnQiKSk7CiAgICB9CiAgfQogIGFjY2Vzc2VkUm91dGVycy5zb3J0KGNvbXBhcmUoInNvcnQiKSk7Cn0KCi8v6ZmN5bqP5q+U6L6D5Ye95pWwCmZ1bmN0aW9uIGNvbXBhcmUocCkgewogIHJldHVybiBmdW5jdGlvbiAobSwgbikgewogICAgbGV0IGEgPSBtW3BdOwogICAgbGV0IGIgPSBuW3BdOwogICAgcmV0dXJuIGIgLSBhOwogIH07Cn0KY29uc3QgcGVybWlzc2lvbiA9IHsKICBzdGF0ZTogewogICAgcm91dGVyczogY29uc3RhbnRSb3V0ZXJNYXAsCiAgICBhZGRSb3V0ZXJzOiBbXQogIH0sCiAgbXV0YXRpb25zOiB7CiAgICBTRVRfUk9VVEVSUzogKHN0YXRlLCByb3V0ZXJzKSA9PiB7CiAgICAgIHN0YXRlLmFkZFJvdXRlcnMgPSByb3V0ZXJzOwogICAgICBzdGF0ZS5yb3V0ZXJzID0gY29uc3RhbnRSb3V0ZXJNYXAuY29uY2F0KHJvdXRlcnMpOwogICAgfQogIH0sCiAgYWN0aW9uczogewogICAgR2VuZXJhdGVSb3V0ZXMoewogICAgICBjb21taXQKICAgIH0sIGRhdGEpIHsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gewogICAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGEsJ+i3r+eUsScpCiAgICAgICAgY29uc3QgewogICAgICAgICAgbWVudXMKICAgICAgICB9ID0gZGF0YTsKICAgICAgICBjb25zdCB7CiAgICAgICAgICB1c2VybmFtZQogICAgICAgIH0gPSBkYXRhOwogICAgICAgIGNvbnN0IGFjY2Vzc2VkUm91dGVycyA9IGNvbnN0YW50Um91dGVyTWFwLmZpbHRlcih2ID0+IHsKICAgICAgICAgIC8vIGFkbWlu5biQ5Y+355u05o6l6L+U5Zue5omA5pyJ6I+c5Y2VCiAgICAgICAgICBpZiAodXNlcm5hbWUgPT09ICd6bGFkbWluJykgcmV0dXJuIHRydWU7CiAgICAgICAgICBpZiAoaGFzUGVybWlzc2lvbihtZW51cywgdikpIHsKICAgICAgICAgICAgaWYgKHYuY2hpbGRyZW4gJiYgdi5jaGlsZHJlbi5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgdi5jaGlsZHJlbiA9IHYuY2hpbGRyZW4uZmlsdGVyKGNoaWxkID0+IHsKICAgICAgICAgICAgICAgIGlmIChoYXNQZXJtaXNzaW9uKG1lbnVzLCBjaGlsZCkpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGNoaWxkOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIHJldHVybiB2OwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHJldHVybiB2OwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSk7CiAgICAgICAgLy/lr7noj5zljZXov5vooYzmjpLluo8KICAgICAgICBzb3J0Um91dGVycyhhY2Nlc3NlZFJvdXRlcnMpOwogICAgICAgIGNvbW1pdCgnU0VUX1JPVVRFUlMnLCBhY2Nlc3NlZFJvdXRlcnMpOwogICAgICAgIHJlc29sdmUoKTsKICAgICAgfSk7CiAgICB9CiAgfQp9OwpleHBvcnQgZGVmYXVsdCBwZXJtaXNzaW9uOw=="},{"version":3,"names":["constantRouterMap","hasPermission","menus","route","name","currMenu","getMenu","title","meta","icon","hidden","sort","undefined","i","length","menu","sortRouters","accessedRouters","router","children","compare","p","m","n","a","b","permission","state","routers","addRouters","mutations","SET_ROUTERS","concat","actions","GenerateRoutes","commit","data","Promise","resolve","username","filter","v","child"],"sources":["F:/viteFiles/teston/src/store/modules/permission.js"],"sourcesContent":["import {constantRouterMap } from '@/router/index';\r\n\r\n//判断是否有权限访问该菜单\r\nfunction hasPermission(menus, route) {\r\n  if (route.name) {\r\n    let currMenu = getMenu(route.name, menus);\r\n    if (currMenu!=null) {\r\n      //设置菜单的标题、图标和可见性\r\n      if (currMenu.title != null && currMenu.title !== '') {\r\n        route.meta.title = currMenu.title;\r\n      }\r\n      if (currMenu.icon != null && currMenu.title !== '') {\r\n        route.meta.icon = currMenu.icon;\r\n      }\r\n      if(currMenu.hidden!=null){\r\n        route.hidden = currMenu.hidden !== 0;\r\n      }\r\n      if (currMenu.sort != null && currMenu.sort !== '') {\r\n        route.sort = currMenu.sort;\r\n      }\r\n      return true;\r\n    } else {\r\n      route.sort = 0;\r\n      if (route.hidden !== undefined && route.hidden === true) {\r\n        return true;\r\n      } else {\r\n        return false;\r\n      }\r\n    }\r\n  } else {\r\n    return true\r\n  }\r\n}\r\n\r\n//根据路由名称获取菜单\r\nfunction getMenu(name, menus) {\r\n  for (let i = 0; i < menus.length; i++) {\r\n    let menu = menus[i];\r\n    if (name===menu.name) {\r\n      return menu;\r\n    }\r\n  }\r\n  return null;\r\n}\r\n\r\n//对菜单进行排序\r\nfunction sortRouters(accessedRouters) {\r\n  for (let i = 0; i < accessedRouters.length; i++) {\r\n    let router = accessedRouters[i];\r\n    if(router.children && router.children.length > 0){\r\n      router.children.sort(compare(\"sort\"));\r\n    }\r\n  }\r\n  accessedRouters.sort(compare(\"sort\"));\r\n}\r\n\r\n//降序比较函数\r\nfunction compare(p){\r\n  return function(m,n){\r\n    let a = m[p];\r\n    let b = n[p];\r\n    return b - a;\r\n  }\r\n}\r\n\r\nconst permission = {\r\n  state: {\r\n    routers: constantRouterMap,\r\n    addRouters: []\r\n  },\r\n  mutations: {\r\n    SET_ROUTERS: (state, routers) => {\r\n      state.addRouters = routers;\r\n      state.routers = constantRouterMap.concat(routers);\r\n    }\r\n  },\r\n  actions: {\r\n    GenerateRoutes({ commit }, data) {\r\n      return new Promise(resolve => {\r\n        // console.log(data,'路由')\r\n        const { menus } = data;\r\n        const { username } = data;\r\n        const accessedRouters = constantRouterMap.filter(v => {\r\n          // admin帐号直接返回所有菜单\r\n          if(username==='zladmin') return true;\r\n          if (hasPermission(menus, v)) {\r\n            if (v.children && v.children.length > 0) {\r\n              v.children = v.children.filter(child => {\r\n                if (hasPermission(menus, child)) {\r\n                  return child\r\n                }\r\n                return false;\r\n              });\r\n              return v\r\n            } else {\r\n              return v\r\n            }\r\n          }\r\n          return false;\r\n        });\r\n        //对菜单进行排序\r\n        sortRouters(accessedRouters);\r\n        commit('SET_ROUTERS', accessedRouters);\r\n        resolve();\r\n      })\r\n    }\r\n  }\r\n};\r\n\r\nexport default permission;\r\n\r\n"],"mappings":"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"}]}